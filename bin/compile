#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir> <env-dir>

echo_header() {
  echo "-----> $1"
}
echo_indented() {
  echo "       $1"
}

output_dir=.profile.d
output_path=$output_dir/version.sh

echo_header "Creating profile.d script"

short_version=${SOURCE_VERSION:0:7} 
echo_indented "Using short version $short_version"

mkdir -p $1/$output_dir
cat << EOF > $1/$output_path
# default VERSION to build source version
export VERSION=\${VERSION:-$short_version}
EOF

echo_indented "Script installed to $output_path"
